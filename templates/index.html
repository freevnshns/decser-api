<!doctype html>
<html lang="en" dir="ltr">
<head>
    <meta charset="utf-8"/>
    <title>{{user_name}} | Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="icon" type="image/ico" href="{{url_for('static',filename='icons/favicon.ico')}}">

    <link rel="stylesheet" href="{{ url_for('static',filename='css/foundation.css')}}"/>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/custom.css')}}"/>

    <script src="{{ url_for('static',filename='js/custom.js')}}"></script>
</head>

<body>
<nav class="top-bar" data-topbar role="navigation">
    <ul class="title-area">
        <li class="name">
            <h1><a href="#">Decser</a></h1>
        </li>
    </ul>
</nav>
<header>
    <div class="row">
        <div class="large-6 columns profile-image">
            <a href="#" data-reveal-id="change-Profile-Picture">
                <img src="/profilePicture_S"
                     srcset="/profilePicture_S 400w, /profilePicture_M 800w, /profilePicture_L 1200w"
                     alt="Upload a Profile Picture of yours" id="profile-image-inset">
            </a>
            <br>
        </div>
        <div class="large-6 columns">
            <h3 class="user-name">
                {{user_name}}
            </h3>
            <hr/>
            <a href="#" data-reveal-id="description-change-modal">
                <h4 class="subheader user-info">
                    {{user_description}}
                </h4>
            </a>
        </div>
    </div>
</header>
<div class="row control-panel">
    <div class="large-12 columns">
        <div class="radius panel panel-material">
            <fieldset>
                <legend>Shared Files</legend>
                <div class="row collapse">
                    <div class="large-3 small-5 columns">
                        <a href="#" data-reveal-id="file-upload-modal" class="prefix button expand"
                           onclick="loadFiles()">Upload</a>
                    </div>
                    <div class="large-3 small-5 columns">
                        <a href="#" data-reveal-id="file-delete-modal" class="postfix button expand"
                           onclick="loadFilesDelete()">Delete</a>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</div>
<div class="row" id="chatToggle">
    <div class="small-3 small-centered large-centered columns">
        <a class="button tiny expand">
            Show Shoutbox
        </a>
    </div>
</div>
<div class="row chat">
    <div class="large-12 columns">
        <div class="radius panel panel-material">
            <ul id="chat_message_box">
                <!-- <li></li> -->
            </ul>
        </div>
    </div>
</div>
<div class="row panel chat panel-material">
    <fieldset>
        <legend>Shoutbox</legend>
        <div class="large-8 small-8 columns">
            <input type="text" name="chat_message" id="chat_message" placeholder="Press Enter to Send"/>
        </div>
        <div class="large-4 small-4 columns">
            <input type="text" id="chat_message_sender" placeholder="Name"/>
        </div>
    </fieldset>
</div>
<div id="file-upload-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true"
     role="dialog">
    <h3>
        Select a file to upload
    </h3>
    <form action="/uploadFiles" method=post enctype=multipart/form-data>
        <p>
            <input type=file name=file>
            <input type=submit class="button tiny round" value=Upload>
    </form>
    <ul id="file-list" class="small-block-grid-2 medium-block-grid-3 large-block-grid-4">
        <!-- <li></li> -->
    </ul>
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>
<div id="file-delete-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true"
     role="dialog">
    <h3>
        Select file to delete
    </h3>
    <ul id="file-list-delete" class="small-block-grid-2 medium-block-grid-3 large-block-grid-4">
        <!-- <li></li> -->
    </ul>
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>
<div id="description-change-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true"
     role="dialog">
    <h3>
        Enter a new description for yourself
    </h3>

    <form action="/editDescription" method="POST">
        <input type="text" name="description">
        <input type="submit" value="Change">
    </form>
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>
<div id="change-Profile-Picture" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true"
     role="dialog">
    <h3>
        Change your Display Picture
    </h3>
    <form action="/changeProfilePicture" method=post enctype=multipart/form-data>
        <p>
            <input type=file name=file>
            <input type=submit value=Upload>
    </form>
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>
<script src="{{ url_for('static',filename='js/jquery.js')}}"></script>
<script src="{{ url_for('static',filename='js/foundation.js')}}"></script>
<script type="text/javascript">
    "use strict";
    $(document).foundation();
    var doc = document.documentElement;
    doc.setAttribute('data-useragent', navigator.userAgent);
    jQuery(document).ready(function($) {
        $('.chat').hide('fast');
        $('#chatToggle').on('click', function(event) {
            event.preventDefault();
            /* Act on the event */
            $(this).hide('slow');
            $('header').slideUp('slow');
            $('.chat').show('fast');
            retrieveChat();
            $('#chat_message_box').before('<div class="row collapse"><div class="small-3 small-centered large-centered columns"><a class="secondary button tiny expand" id="refresher">Refresh</a></div></div>');
            $('#refresher').on('click', function(event) {
                event.preventDefault();
                /* Act on the event */
                retrieveChat();
            });
        });
    });
    var triggerLink = document.getElementById("chat_message");
    triggerLink.addEventListener('keyup', send_chat_message, false);
</script>
</body>
</html>
